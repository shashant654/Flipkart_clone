{% extends 'base.html' %}
{% load static %}
{% block title %}Your Home page{% endblock %}

{% block content %}
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      <i class="bi bi-check-circle-fill me-2"></i>
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
{% endif %}

<!-- Hero Banner -->
<section class="hero-banner bg-light py-5 mb-5">
  <div class="container">
    <div class="row justify-content-center text-center">
      <div class="col-lg-8">
        <h1 class="display-4 fw-bold mb-3 text-gradient-info">
          Welcome to <span>YourStore</span>
        </h1>
        <p class="lead mb-4 text-muted">
          Discover amazing products at unbeatable prices
        </p>
        <a href="{% url 'categories' %}" class="btn btn-info rounded-pill px-4 py-2 text-white">
          <i class="bi bi-cart3 me-2"></i> Shop Now
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Categories Section -->
<section class="categories-section mb-5">
  <div class="container">
    <div class="section-header text-center mb-5">
      <h2 class="fw-bold display-5 text-gradient-info">
        <i class="bi bi-stars me-2"></i>Top Categories
      </h2>
      <p class="text-muted mt-3">Browse our most popular categories</p>
    </div>
    
    <div class="row g-4">
      {% for cat in categories %}
      <div class="col-lg-4 col-md-6">
        <div class="card h-100 border-0 shadow-sm rounded-4 overflow-hidden hover-lift">
          <div class="position-relative overflow-hidden" style="height: 220px;">
            <img src="{{ cat.image.url }}" class="img-fluid w-100 h-100 object-cover" alt="{{ cat.name }}">
            <div class="category-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-end p-4">
              <div>
                <h3 class="text-white mb-2">{{ cat.name }}</h3>
                <a href="{% url 'category_products' cat.id %}" class="btn btn-outline-light btn-sm stretched-link">
                  Explore <i class="bi bi-arrow-right ms-1"></i>
                </a>
              </div>
            </div>
          </div>
          <div class="card-body bg-light">
            <p class="text-muted mb-0">{{ cat.description|truncatewords:20 }}</p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Featured Products -->
<section id="featured" class="featured-products mb-5 bg-light py-5">
  <div class="container">
    <div class="section-header text-center mb-5">
      <h2 class="fw-bold display-5 text-gradient-info">
        <i class="bi bi-lightning-charge-fill me-2"></i>Featured Products
      </h2>
      <p class="text-muted mt-3">Our most popular products this week</p>
    </div>
    
    <div class="row g-4">
      {% for product in products %}
      <div class="col-lg-3 col-md-6">
        <div class="card h-100 border-0 rounded-4 overflow-hidden shadow-sm hover-lift">
          <div class="position-relative">
            <img src="{{ product.image.url }}" class="card-img-top" style="height: 200px; object-fit: cover;" alt="{{ product.name }}">
            {% if product.discount_percentage %}
            <span class="badge bg-danger position-absolute top-0 end-0 m-2 shadow">
              {{ product.discount_percentage }}% OFF
            </span>
            {% endif %}
          </div>
          <div class="card-body px-3 py-3">
            <h5 class="card-title fw-semibold mb-1">{{ product.name }}</h5>
            <div class="d-flex justify-content-between align-items-center mb-2">
              <div>
                <span class="text-success fw-bold fs-5">₹{{ product.selling_price }}</span>
                {% if product.original_price %}
                <del class="text-muted small ms-2">₹{{ product.original_price }}</del>
                {% endif %}
              </div>
              <span class="text-warning small">
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-half"></i>
              </span>
            </div>
            <div class="d-flex gap-2">
              <a href="{% url 'add_to_cart' product.id %}" class="btn btn-info flex-grow-1 rounded-pill text-white">
                <i class="bi bi-cart-plus me-1"></i> Add to Cart
              </a>
              <a href="#" class="btn btn-outline-secondary rounded-circle">
                <i class="bi bi-heart"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    
    <div class="text-center mt-4">
      <a href="#" class="btn btn-outline-info rounded-pill px-4">
        View All Products <i class="bi bi-arrow-right ms-2"></i>
      </a>
    </div>
  </div>
</section>

<!-- Promotional Banner -->
<section class="promo-banner mb-5">
  <div class="container-fluid bg-gradient-info text-white py-5 rounded-4 position-relative overflow-hidden">
    <div class="container position-relative z-index-1">
      <div class="row justify-content-center text-center">
        <div class="col-lg-8">
          <h3 class="display-6 fw-bold mb-3">Big Summer Sale!</h3>
          <p class="lead mb-4">Up to 50% off on Electronics & Fashion</p>
          <div class="countdown-timer d-flex justify-content-center gap-3 mb-4">
            <div class="countdown-item bg-white text-dark rounded-3 p-2 shadow">
              <span class="fw-bold fs-4" id="days">00</span>
              <span class="d-block small">Days</span>
            </div>
            <div class="countdown-item bg-white text-dark rounded-3 p-2 shadow">
              <span class="fw-bold fs-4" id="hours">00</span>
              <span class="d-block small">Hours</span>
            </div>
            <div class="countdown-item bg-white text-dark rounded-3 p-2 shadow">
              <span class="fw-bold fs-4" id="minutes">00</span>
              <span class="d-block small">Mins</span>
            </div>
            <div class="countdown-item bg-white text-dark rounded-3 p-2 shadow">
              <span class="fw-bold fs-4" id="seconds">00</span>
              <span class="d-block small">Secs</span>
            </div>
          </div>
          <a href="#" class="btn btn-light btn-lg px-4 rounded-pill shadow-sm">
            <i class="bi bi-lightning-charge-fill text-info me-2"></i> Shop the Sale
          </a>
        </div>
      </div>
    </div>
    <div class="promo-pattern"></div>
  </div>
</section>

<!-- Newsletter Subscription -->
<section class="newsletter-section mb-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="bg-white p-4 p-lg-5 rounded-4 shadow-sm text-center">
          <div class="mb-4">
            <i class="bi bi-envelope-open-fill text-info fs-1"></i>
          </div>
          <h3 class="fw-bold mb-3">Stay Updated</h3>
          <p class="text-muted mb-4">Subscribe to our newsletter for exclusive deals and updates</p>
          
          <form class="row g-2 justify-content-center">
            <div class="col-md-8">
              <input type="email" class="form-control form-control-lg border-info" placeholder="Enter your email" required>
            </div>
            <div class="col-md-4">
              <button class="btn btn-info btn-lg w-100 rounded-pill" type="submit">
                Subscribe <i class="bi bi-send-fill ms-2"></i>
              </button>
            </div>
          </form>
          
          <div class="mt-3 small text-muted">
            <i class="bi bi-shield-lock me-1"></i> We respect your privacy. Unsubscribe at any time.
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .bg-gradient-info {
    background: linear-gradient(135deg, #17a2b8, #1abc9c);
  }
  
  .text-gradient-info {
    background: linear-gradient(to right, #17a2b8, #1abc9c);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
  
  .hover-lift {
    transition: all 0.3s ease;
  }
  
  .hover-lift:hover {
    transform: translateY(-5px);
    box-shadow: 0 1rem 2rem rgba(0,0,0,0.1) !important;
  }
  
  .category-overlay {
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  
  .hover-lift:hover .category-overlay {
    opacity: 1;
  }
  
  .btn-info {
    background-color: #17a2b8;
    border-color: #17a2b8;
    transition: all 0.2s ease;
  }
  
  .btn-info:hover {
    background-color: #138496;
    border-color: #117a8b;
    transform: translateY(-2px);
  }
  
  .btn-outline-info {
    color: #17a2b8;
    border-color: #17a2b8;
  }
  
  .btn-outline-info:hover {
    background-color: rgba(23, 162, 184, 0.1);
  }
  
  .rounded-pill {
    border-radius: 50rem !important;
  }
  
  .promo-pattern {
    position: absolute;
    top: 0;
    right: 0;
    width: 50%;
    height: 100%;
    background-image: radial-gradient(rgba(255,255,255,0.15) 1px, transparent 1px);
    background-size: 15px 15px;
  }
</style>

<script>
  // Countdown Timer
  function updateCountdown() {
    const endDate = new Date();
    endDate.setDate(endDate.getDate() + 7); // 7 days from now
    
    const now = new Date().getTime();
    const distance = endDate - now;
    
    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
    document.getElementById("days").innerHTML = days.toString().padStart(2, '0');
    document.getElementById("hours").innerHTML = hours.toString().padStart(2, '0');
    document.getElementById("minutes").innerHTML = minutes.toString().padStart(2, '0');
    document.getElementById("seconds").innerHTML = seconds.toString().padStart(2, '0');
  }
  
  updateCountdown();
  setInterval(updateCountdown, 1000);
</script>
{% endblock %}